# Приложение для анализа банковских операций

## Описание:

В проекте разрабатывается приложение для личного кабинета, позволяющее проанализировать операции по счетам пользователя 
и сформировать отчеты.

## Установка:

1. Клонируйте репозиторий:
```
git clone https://github.com/ekomendant/Transaction_analytics.git
```

2. Установите зависимости:
```
pip install -r requirements.txt
```

## Получение доступа к API:

В проекте используется обращение к API ресурсов https://apilayer.com/ и https://www.alphavantage.co/ для получения 
курса валют и стоимости акций.

Для работы функций необходимо получить API-ключи к ресурсам. Затем:
1. в основной директории проекта создать копию файла `.env.example`,
2. переименовать файл в `.env`,
3. указать полученные API-ключи.

## Модули и примеры использования.

По умолчанию проект содержит выгрузку операций за период 2018 по 2021 года (включительно). Для получения отчетов 
необходимо указывать даты в указанном диапазоне, либо заменить файл `operations.xlxs` в директории `data`.

### Модуль main.py
Модуль содержит функцию `main`, которая запрашивает у пользователя номер отчета и выводит данные, соответствующие его 
выбору.

### Модуль views.py
Модуль содержит 2 функции:
1. `show_home_page` - функция формирует JSON-ответ с данными для заполнения главной страницы онлайн-банка (приветствие, 
данные о расходах по картам, ТОП-5 транзакций по сумме, курсы валют, стоимость акций).
2. `show_events_page` - Функция формирует JSON-ответ с данными для заполнения страницы онлайн-банка "События" (данные о 
расходах и доходах, курсы валют, стоимость акций).

### Модуль reports.py
Модуль содержит 4 функции:
1. `spending_by_category` - функция возвращает траты по заданной категории за последние три месяца (от переданной даты).
2. `spending_by_weekday` - функция возвращает средние траты в каждый из дней недели за последние три месяца (от 
переданной даты).
3. `spending_by_workday` - функция выводит средние траты в рабочий и в выходной день за последние три месяца (от 
переданной даты).
4. `write_report` - декоратор для функций-отчетов, который записывает в файл результат функции, формирующей отчет.

### Модуль services.py
Модуль содержит 1 функцию:
1. `profitable_categories` - функция определяет выгодные категории повышенного кэшбэка, основываясь на сумме расходов 
по каждой категории за выбранный месяц.

### Модуль utils.py
Модуль содержит набор вспомогательных функций, выполняющих узконаправленные действия для формирования вышеперечисленных 
отчетов.

## Тестирование:

Тесты всех функций реализованы в директории `tests`. 
Для запуска тестов введите в терминале команду:
```
pytest
```

Для формирования отчета о покрытии тестами введите в терминале команду:
```
pytest --cov=src --cov-report=html
```
Результат покрытия тестами в HTML-формате можно посмотреть в [отчете](htmlcov/index.html).  

## Лицензия:

Проект распространяется под [лицензией MIT](LICENSE).
